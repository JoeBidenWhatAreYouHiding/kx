##############################################
# Yunnan Scripted effects					#
# By Drozdovite, Wrealith Noel and Angry Bird#
##############################################
end_of_yunnan_civil_war = {
	load_oob = YUN_post_CW
	clr_country_flag = YUN_let_the_games_begin
	remove_ideas = YUN_chaos_army
	603 = { set_demilitarized_zone = no }
	816 = { set_demilitarized_zone = no }
	1051 = { set_demilitarized_zone = no }
	NSW = {
		every_unit_leader = {
			limit = {
				OR = {
					has_id = 5003
					has_id = 5004
					has_id = 5005
					has_id = 5008
					has_id = 5009
					has_id = 5010
					has_id = 5011
					has_id = 5012
					has_id = 5014
				}
			}
			set_nationality = YUN
		}
	}
}

YUN_black_monday_recovery_left_first = {

	if = {
		limit = {
			has_country_flag = YUN_left_first_set_flag
		}
		if = {
			limit = { has_idea = YUN_black_monday }
			swap_ideas = {
				remove_idea = YUN_black_monday
				add_idea = YUN_black_monday_left_1
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_left_1 }
			swap_ideas = {
				remove_idea = YUN_black_monday_left_1
				add_idea = YUN_black_monday_left_2
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_left_2 }
			swap_ideas = {
				remove_idea = YUN_black_monday_left_2
				add_idea = YUN_black_monday_left_3
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_left_3 }
			swap_ideas = {
				remove_idea = YUN_black_monday_left_3
				add_idea = YUN_black_monday_left_4
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_left_4 }
			swap_ideas = {
				remove_idea = YUN_black_monday_left_4
				add_idea = YUN_black_monday_left_5
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_left_5 }
			swap_ideas = {
				remove_idea = YUN_black_monday_left_5
				add_idea = YUN_black_monday_left_6
			}
			clr_country_flag = YUN_left_first_set_flag
			set_country_flag = YUN_left_first_set_flag_finished
		}
	}
	if = {
		limit = { has_country_flag = YUN_right_first_set_flag_finished }
		if = {
			limit = { has_idea = YUN_black_monday_right_6 }
			swap_ideas = {
				remove_idea = YUN_black_monday_right_6
				add_idea = YUN_black_monday_right_7
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_right_7 }
			swap_ideas = {
				remove_idea = YUN_black_monday_right_7
				add_idea = YUN_black_monday_right_8
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_right_8 }
			swap_ideas = {
				remove_idea = YUN_black_monday_right_8
				add_idea = YUN_black_monday_right_9
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_right_9 }
			swap_ideas = {
				remove_idea = YUN_black_monday_right_9
				add_idea = YUN_black_monday_right_10
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_right_10 }
			swap_ideas = {
				remove_idea = YUN_black_monday_right_10
				add_idea = YUN_black_monday_right_11
			}
			clr_country_flag = YUN_right_first_set_flag
			clr_country_flag = YUN_right_first_set_flag_finished
			clr_country_flag = YUN_left_first_set_flag
			clr_country_flag = YUN_left_first_set_flag_finished
		}
	}
}

YUN_black_monday_recovery_right_first = {

	if = {
		limit = {
			has_country_flag = YUN_right_first_set_flag
		}
		if = {
			limit = { has_idea = YUN_black_monday }
			swap_ideas = {
				remove_idea = YUN_black_monday
				add_idea = YUN_black_monday_right_1
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_right_1 }
			swap_ideas = {
				remove_idea = YUN_black_monday_right_1
				add_idea = YUN_black_monday_right_2
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_right_2 }
			swap_ideas = {
				remove_idea = YUN_black_monday_right_2
				add_idea = YUN_black_monday_right_3
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_right_3 }
			swap_ideas = {
				remove_idea = YUN_black_monday_right_3
				add_idea = YUN_black_monday_right_4
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_right_4 }
			swap_ideas = {
				remove_idea = YUN_black_monday_right_4
				add_idea = YUN_black_monday_right_5
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_right_5 }
			swap_ideas = {
				remove_idea = YUN_black_monday_right_5
				add_idea = YUN_black_monday_right_6
			}
			clr_country_flag = YUN_right_first_set_flag
			set_country_flag = YUN_right_first_set_flag_finished
		}
	}
	if = {
		limit = { has_country_flag = YUN_left_first_set_flag_finished }
		if = {
			limit = { has_idea = YUN_black_monday_left_6 }
			swap_ideas = {
				remove_idea = YUN_black_monday_left_6
				add_idea = YUN_black_monday_left_7
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_left_7 }
			swap_ideas = {
				remove_idea = YUN_black_monday_left_7
				add_idea = YUN_black_monday_left_8
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_left_8 }
			swap_ideas = {
				remove_idea = YUN_black_monday_left_8
				add_idea = YUN_black_monday_left_9
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_left_9 }
			swap_ideas = {
				remove_idea = YUN_black_monday_left_9
				add_idea = YUN_black_monday_left_10
			}
		}
		else_if = {
			limit = { has_idea = YUN_black_monday_left_10 }
			swap_ideas = {
				remove_idea = YUN_black_monday_left_10
				add_idea = YUN_black_monday_left_11
			}
			clr_country_flag = YUN_right_first_set_flag
			clr_country_flag = YUN_right_first_set_flag_finished
			clr_country_flag = YUN_left_first_set_flag
			clr_country_flag = YUN_left_first_set_flag_finished
		}
	}
}

YUN_unlock_templates = {

}
RKMT_set_leadership_effect = {
	if = {
		limit = {
			GXC = { is_ai = yes }
			YUN = { is_ai = no }
		}
		YUN = {
			if = {
				limit = {
					china_is_potential_government = no
				}
				set_potential_national_government = yes
			}
			custom_effect_tooltip = tooltip_white_line
			set_temp_variable = { target = GXC }
			china_puppet_TARGET_effect = yes #YUN will puppet GXC if YUN is a player
		}
	}
	else = {
		GXC = {
			if = {
				limit = {
					china_is_potential_government = no
				}
				country_event = { id = lngkmt.4 days = 1 }
			}
			custom_effect_tooltip = tooltip_white_line
			set_temp_variable = { target = YUN }
			china_puppet_TARGET_effect = yes #GXC will puppet YUN if YUN is ai
		}
	}
}
YUN_general_joins_ROOT = {
	hidden_effect = {
		remove_unit_leader_trait = hidden_sympathies
		remove_unit_leader_trait = GXC_rkmt_officer
		demote_leader = yes
	}
	set_nationality = ROOT
}
