SPA_societal_recovery = {
	if = {
		limit = { has_idea = SPR_social_breakdown }
		swap_ideas = {
			remove_idea = SPR_social_breakdown
			add_idea = SPR_social_breakdown_2
		}
	}
	else_if = {
		limit = { has_idea = SPR_social_breakdown_2 }
		swap_ideas = {
			remove_idea = SPR_social_breakdown_2
			add_idea = SPR_social_breakdown_3
		}
	}
	else_if = {  #Intended. Putting else will cause issues!
		limit = { has_idea = SPR_social_breakdown_3 }
		remove_ideas = SPR_social_breakdown_3
	}
}
SPR_civil_war_prelude_setup = {
	set_country_flag = SPR_civil_war_unavoidable
	if = {
		limit = {
			has_idea = SPR_social_breakdown
		}
		swap_ideas = {
			remove_idea = SPR_social_breakdown
			add_idea = SPR_social_breakdown_civil_war_unavoidable
		}
	}
	if = {
		limit = {
			has_idea = SPR_social_breakdown_2
		}
		swap_ideas = {
			remove_idea = SPR_social_breakdown_2
			add_idea = SPR_social_breakdown_civil_war_unavoidable
		}
	}
	if = {
		limit = {
			has_idea = SPR_social_breakdown_3
		}
		swap_ideas = {
			remove_idea = SPR_social_breakdown_3
			add_idea = SPR_social_breakdown_civil_war_unavoidable
		}
	}
	remove_power_balance = {
		id = SPR_burning_house_of_cards
	}
	every_owned_state = {
		limit = {
			has_state_flag = is_car_state
		}
		CAR = { add_state_core = PREV }
		set_demilitarized_zone = yes
	}
	every_state = {
		limit = {
			is_claimed_by = CAR
		}
		CAR = { remove_state_claim = PREV }
	}
	every_owned_state = {
		limit = {
			has_state_flag = is_cnt_state
		}
		CNT = { add_state_core = PREV }
		set_demilitarized_zone = yes
	}
	every_state = {
		limit = {
			is_claimed_by = CNT
		}
		CNT = { remove_state_claim = PREV }
	}
	every_state = {
		limit = {
			is_core_of = SPR
			OR = {
				is_core_of = CAR
				is_core_of = CNT
			}
		}
		SPR = { 
			remove_state_core = PREV
			add_state_claim = PREV
		}
	}
}
SPR_civil_war_start_effect = {
	set_global_flag = spanish_civil_war
	if = {
		limit = {
			SPR = { exists = yes }
		}
		SPR = {
			if = {
				limit = {
					CAR = { exists = yes }
					SPR = { NOT = { has_war_with = CAR } }
				}
				declare_war_on = {
					target = CAR
					type = annex_everything
				}
			}
			if = {
				limit = {
					CNT = { exists = yes }
					SPR = { NOT = { has_war_with = CNT } }
				}
				declare_war_on = {
					target = CNT
					type = annex_everything
				}
			}
			every_state = {
				limit = {
					is_core_of = CAR
					NOT = { is_core_of = SPR }
				}
				SPR = { add_state_claim = PREV }
			}
			every_state = {
				limit = {
					is_core_of = CNT
					NOT = { is_core_of = SPR }
				}
				SPR = { add_state_claim = PREV }
			}
		}
	}
	if = {
		limit = {
			CNT = { exists = yes }
		}
		CNT = {
			if = {
				limit = {
					CAR = { exists = yes }
					CNT = { NOT = { has_war_with = CAR } }
				}
				declare_war_on = {
					target = CAR
					type = annex_everything
				}
			}
			if = {
				limit = {
					SPR = { exists = yes }
					CNT = { NOT = { has_war_with = SPR } }
				}
				declare_war_on = {
					target = SPR
					type = annex_everything
				}
			}
			every_state = {
				limit = {
					is_core_of = CAR
					NOT = { is_core_of = CNT }
				}
				CNT = { add_state_claim = PREV }
			}
			every_state = {
				limit = {
					is_core_of = SPR
					NOT = { is_core_of = CNT }
				}
				CNT = { add_state_claim = PREV }
			}
			add_ideas = SPR_civil_war_idea
		}
	}
	if = {
		limit = {
			CAR = { exists = yes }
		}
		CAR = {
			if = {
				limit = {
					CNT = { exists = yes }
					CAR = { NOT = { has_war_with = CNT } }
				}
				declare_war_on = {
					target = CNT
					type = annex_everything
				}
			}
			if = {
				limit = {
					SPR = { exists = yes }
					CAR = { NOT = { has_war_with = SPR } }
				}
				declare_war_on = {
					target = SPR
					type = annex_everything
				}
			}
			every_state = {
				limit = {
					is_core_of = CNT
					NOT = { is_core_of = CAR }
				}
				CAR = { add_state_claim = PREV }
			}
			every_state = {
				limit = {
					is_core_of = SPR
					NOT = { is_core_of = CAR }
				}
				CAR = { add_state_claim = PREV }
			}
			add_ideas = SPR_civil_war_idea
		}
	}
}

SPR_bm_intro_latin_america_center_effect = {
	every_country = {
		limit = {
			OR = {
				is_in_south_america = yes
				is_in_central_america = yes
				capital_scope = {
					is_core_of = MEX
				}
			}
			NOT = {
				OR = {
					tag = BRA
					has_communist_government = yes
					has_socialist_government = yes
					has_colonial_government = yes
					is_subject = yes
				}
			}
		}
		THIS = {
			country_event = {
				id = sprd.1192
				days = 4
			}
		}
	}
}

SPR_bm_intro_latin_america_left_effect = {
	every_country = {
		limit = {
			OR = {
				is_in_south_america = yes
				is_in_central_america = yes
				capital_scope = {
					is_core_of = MEX
				}
			}
			NOT = {
				OR = {
					tag = BRA
					has_communist_government = yes
					has_colonial_government = yes
					has_dictatorship_government = yes
					is_subject = yes
				}
			}
		}
		THIS = {
			country_event = {
				id = sprd.1192
				days = 4
			}
		}
	}
}