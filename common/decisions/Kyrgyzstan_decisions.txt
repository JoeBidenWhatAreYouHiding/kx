KYR_war_preparation = {
	KYR_prep_distribute_equipment = {
		icon = GFX_decision_generic_protection
		allowed = { always = no } #manually activated

		available = {
			check_variable = {
				var = KYR_prep
				value = 150
				compare = less_than
			}
		}

		custom_cost_text = 150_guns
		custom_cost_trigger = {
			has_equipment = { infantry_equipment > 149 }
		}

		days_re_enable = 3
		ai_will_do = {
			factor = 0

		}

		visible = {
			NOT = { has_global_flag = CA_russia_war_started }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete KYR_prep_distribute_equipment"
			hidden_effect = {
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = -150
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove KYR_prep_distribute_equipment"
			add_to_variable = {
				KYR_prep = 7
				tooltip = CA_prep_tooltip
			}
			add_popularity = {
				ideology = radical_socialist
				popularity = 0.02
			}
		}
	}

	KYR_prep_sell_supplies = {
		icon = hol_attract_foreign_investors
		allowed = { always = no } #manually activated

		days_remove = 30
		days_re_enable = 3
		
		custom_cost_text = CA_prep_5_tooltip
		custom_cost_trigger = {
			check_variable = { KYR_prep > 4.99 }
		}

		ai_will_do = { factor = 0 }

		visible = {
			NOT = { has_global_flag = CA_russia_war_started }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete KYR_prep_sell_supplies"
			subtract_from_variable = { KYR_prep = 5 }
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove KYR_prep_sell_supplies"
			add_political_power = 50
		}
	}

	KYR_conduct_fresh_exercises = {
		icon = generic_military
		allowed = { always = no } #manually activated
				
		fire_only_once = yes
		custom_cost_trigger = {
			command_power > 14
		}
		custom_cost_text = CP_15

		available = {
			has_war = no
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete KYR_conduct_fresh_exercises"
			add_command_power = -15
			if = {
				limit = { has_global_flag = CA_russia_war_started }
				army_experience = 10
			}
			else = {
				add_to_variable = {
					KYR_prep = 5
					tooltip = CA_prep_tooltip
				}
			}
		}
	}
	KYR_implement_fresh_ideas = {
		icon = GFX_decision_generic_operation
		allowed = { always = no } #manually activated
		fire_only_once = yes
		custom_cost_trigger = {
			has_army_experience > 24
		}
		custom_cost_text = army_xp_25

		available = {
			has_war = no			
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete KYR_implement_fresh_ideas"
			army_experience = -25
			if = {
				limit = { has_global_flag = CA_russia_war_started }
				add_doctrine_cost_reduction = {
					name = KYR_implement_fresh_ideas
					cost_reduction = 0.1
					uses = 1
					category = land_doctrine
				}
			}
			else = {
				add_to_variable = {
					KYR_prep = 5
					tooltip = CA_prep_tooltip
				}
			}
		}
	}

	KYR_arm_the_treasonous_southerns = {
		icon = GFX_decision_generic_reorganize_irregulars
		allowed = { always = no } #manually activated
		fire_only_once = yes
		days_remove = 30
		custom_cost_text = 200_guns
		custom_cost_trigger = {
			has_equipment = { infantry_equipment > 199 }
		}

		visible = {
			NOT = { has_global_flag = CA_russia_war_started }
		}

		ai_will_do = { factor = 0 }

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove KYR_arm_the_treasonous_southerns"
			add_to_variable = {
				KYR_prep = 10
				tooltip = CA_prep_tooltip
			}
			hidden_effect = {
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = -200
				}
			}
			add_stability = -0.01
			add_popularity = {
				ideology = paternal_autocrat
				popularity = 0.03
			}
		}
	}
	KYR_sell_opium_for_equipment = {
		icon = GFX_decision_generic_agriculture
		allowed = { always = no } #manually activated
		visible = {
			has_country_flag = KYR_opium_decisions_unlocked
		}
		
		days_remove = 25
		days_re_enable = 25

		custom_cost_text = ALO_decision_cost_stb_5
		custom_cost_trigger = {
			OR = {
				has_stability > 0.05
				has_stability = 0.05
			}
		}

		visible = {
			NOT = { has_global_flag = CA_russia_war_started }
		}

		ai_will_do = { 
			factor = 10 
			modifier = {
				add = 20
				has_stability > 0.15
			} 
			modifier = {
				add = 20
				check_variable = { KYR_opium_control > 0.5 }
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete KYR_sell_opium_for_equipment"
			hidden_effect = {
				add_stability = -0.05
			}
		}	
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove KYR_sell_opium_for_equipment"
			set_temp_variable = { KYR_opium_control_change = -10 }
			KYR_increase_opium_control = yes
			add_to_variable = {
				KYR_prep = 5
				tooltip = CA_prep_tooltip
			}			
			add_equipment_to_stockpile = {
				type = support_equipment
				amount = 50
			}
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = 200
			}
		}
	}
}
KYR_opium_production_decisions = {
	KYR_establish_state_monopoly = {
		icon = GFX_decision_SWI_no_elected_president
		
		cost = 20
		days_remove = 50
		fire_only_once = yes

		modifier = {
			political_power_cost = 0.1
		}

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove KYR_establish_state_monopoly"
			set_temp_variable = { KYR_opium_control_change = 15 }
			KYR_increase_opium_control = yes
			custom_effect_tooltip = KYR_establish_state_monopoly_tt
			add_to_variable = { KYR_opium_trade_political_power_gain = -0.03 }
		}
	}
	KYR_border_control = {
		icon = GFX_decision_soldierly_discipline
		
		available = { has_completed_focus = KYR_Centralised_Command }
		
		cost = 20
		days_remove = 40

		modifier = {
			political_power_cost = 0.4
			consumer_goods_factor = 0.05
		}

		ai_will_do = {
			factor = 10
			modifier = {
				add = ROOT.political_power
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove KYR_border_control"
			set_temp_variable = { KYR_opium_control_change = 10 }
			KYR_increase_opium_control = yes
			custom_effect_tooltip = KYR_border_control_tt
			add_to_variable = { KYR_opium_trade_stability_weekly = 0.001 }
			add_to_variable = { KYR_opium_trade_trade_opinion_factor = -0.15 }
			custom_effect_tooltip = tooltip_white_line
			KYR_decrease_refugee_problem = yes
		}
	}
	KYR_promote_alternative_livelihoods = {
		icon = GFX_decision_generic_agriculture
		
		available = { has_completed_focus = KYR_Agricultural_Expansion }
		
		cost = 0
		days_remove = 50
		days_re_enable = 30

		modifier = {
			political_power_gain = 0.5
			stability_weekly = 0.005
		}

		ai_will_do = {
			factor = 10
			modifier = {
				factor = 0
				has_stability < 0.2
			}
			modifier = {
				factor = 0
				has_political_power > 50
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision KYR_promote_alternative_livelihoods"
			set_temp_variable = { KYR_opium_control_change = 5 }
			KYR_increase_opium_control = yes
			set_temp_variable = { ideology_change_var = 2.5 }
			change_ruling_party_popularity = yes
		}
	}
	KYR_finish_fighting_opium = {
		icon = GFX_decision_generic_civil_support
		allowed = { always = no } # manually activated
		available = {
			hidden_trigger = { always = no }
		}
		cancel_trigger = {
			hidden_trigger = { always = no }
		}
		
		fire_only_once = yes
		selectable_mission = no
		is_good = yes
		days_mission_timeout = 50
		
		cancel_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision cancel KYR_deal_with_mujahideen"
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete KYR_deal_with_mujahideen"
		}
		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout KYR_deal_with_mujahideen"
			KYR_finalize_opium_control = yes
		}
	}
}
KYR_urkun_consequences = {
	KYR_temporary_camps = {
		icon = GFX_decision_eng_trade_unions_support
		
		cost = 20
		days_remove = 50
		fire_only_once = yes

		modifier = {
			political_power_cost = 0.1
		}

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove KYR_temporary_camps"
			KYR_decrease_refugee_problem = yes
		}
	}
	KYR_property_restitution = {
		icon = GFX_decision_SWI_no_elected_president
		
		cost = 20
		days_remove = 40
		days_re_enable = 30

		modifier = {
			political_power_cost = 0.05
			consumer_goods_factor = 0.05
		}

		ai_will_do = {
			factor = 10
			modifier = {
				add = ROOT.political_power
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove KYR_property_restitution"
			KYR_decrease_refugee_problem = yes
		}
	}
	KYR_spread_humanitarian_aid = {
		icon = GFX_decision_SWI_support_humanitarian_efforts
		
		custom_cost_text = KHI_20_support
		custom_cost_trigger = {
			has_equipment = { support_equipment > 19 }
		}
		days_remove = 50
		days_re_enable = 30

		modifier = {
			stability_weekly = 0.005
		}

		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete KYR_spread_humanitarian_aid"
			hidden_effect = {
				add_equipment_to_stockpile = {
					type = support_equipment
					amount = -20
				}
			}
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove KYR_spread_humanitarian_aid"
			KYR_decrease_refugee_problem = yes
			add_to_variable = {
				KYR_prep = -5
				tooltip = CA_prep_tooltip
			}			
		}
	}
	KYR_support_local_economy = {
		icon = GFX_decision_give_cash
		
		cost = 50
		fire_only_once = yes
		
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision KYR_support_local_economy"
			KYR_decrease_refugee_problem = yes
			586 = { increase_state_category_by_one_level = yes }
		}
	}
}

operations = {
	KYR_deal_with_mujahideen = {
		icon = GFX_decision_revolt
		allowed = { always = no } # manually activated
		available = {
			has_completed_focus = KYR_Secure_South_Kyrgyzstan
			has_completed_focus = KYR_Form_Militias
		}
		cancel_trigger = {
			hidden_trigger = { always = no }
		}
		
		fire_only_once = yes
		selectable_mission = no
		is_good = no
		days_mission_timeout = 50
		
		cancel_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision cancel KYR_deal_with_mujahideen"
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete KYR_deal_with_mujahideen"
			remove_ideas = KYR_mujahideen_unrest
			country_event = kyr.3
		}
		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout KYR_deal_with_mujahideen"
			country_event = kyr.4
		}
	}
}