###########################
# Papal State Events
###########################



add_namespace = italy_shared


### ITALIAN SWITZERLAND EVENTS

# italy_shared demands a referendum in Ticino (Italian Switzerland)
country_event = {
	id = italy_shared.70
	title = italy_shared.70.t
	desc = italy_shared.70.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.70.a #They must be joking, right?
		ai_chance = {
			factor = 90
		}
		add_opinion_modifier = { target = FROM modifier = ITA_outraged }
		FROM = { country_event = { id = italy_shared.71 } }
	}
	option = {
		name = italy_shared.70.b #Accept their proposal, call up a referendum on the matter
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				OR = {
					NOT = { tag = SWI }
					has_political_power < 0
				}
			}
		}
		add_opinion_modifier = { target = FROM modifier = ITA_hates_govt }
		add_political_power = -300
		FROM = { country_event = { id = italy_shared.79 } }
	}
}

# The owner of Ticino refuses to hold the referendum
country_event = {
	id = italy_shared.71
	title = italy_shared.71.t
	desc = italy_shared.71.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.71.a #Forget about this matter, just present our territorial claims instead
		ai_chance = {
			factor = 60
			modifier = {
				factor = 1.5
				NOT = {
					has_government = syndicalist
					has_government = totalist
					has_government = radical_socialist
					has_government = national_populist
				}
			}
		}
		add_political_power = -20
		add_state_claim = 761
	}
	option = {
		name = italy_shared.71.b #Mobilize our divisions on the border and threaten them with war
		ai_chance = {
			factor = 40
			modifier = {
				factor = 0
				OR = {
					has_opinion = { target = FROM value > 0 }
					is_in_faction_with = FROM
				}
			}
			modifier = {
				factor = 0
				FROM = { is_in_faction = yes }
				is_in_faction = no
			}
			modifier = {
				factor = 2
				FROM = { is_in_faction = no }
				is_in_faction = yes
			}
			modifier = {
				factor = 0.5
				FROM = { NOT = { tag = SWI } }
			}
		}
		add_political_power = -60
		add_state_claim = 761
		FROM = { country_event = { id = italy_shared.72 days = 5 } }
	}
}

# italy_shared has threated Ticino's owner with war
country_event = {
	id = italy_shared.72
	title = italy_shared.72.t
	desc = italy_shared.72.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	trigger = {
		NOT = { has_war_with = FROM }
		owns_state = 761
	}

	option = {
		name = italy_shared.72.a #We must comply to their demands, the referendum must occur
		ai_chance = {
			factor = 30
			modifier = {
				factor = 1.5
				has_war = yes
			}
			modifier = {
				factor = 0.1
				NOT = { tag = SWI }
			}
		}
		add_political_power = -140
		FROM = { country_event = { id = italy_shared.79 } }
	}
	option = {
		name = italy_shared.72.b #We are ready to defend our country
		ai_chance = {
			factor = 70
			modifier = {
				factor = 2
				is_in_faction = yes
			}
		}
		add_political_power = -40
		FROM = { country_event = { id = italy_shared.73 } }
	}
}

# The owner of Ticino has refused italy_shared's ultimatum
country_event = {
	id = italy_shared.73
	title = italy_shared.73.t
	desc = italy_shared.73.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.73.a #Cancel all plans and demobilize our troops
		ai_chance = {
			factor = 40
			modifier = {
				factor = 2
				FROM = { is_guaranteed_by = GER }
			}
		}
		add_political_power = -20
	}
	option = {
		name = italy_shared.73.b #Cross the border and seize the disputed territories
		ai_chance = {
			factor = 60
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0.5
				FROM = { is_guaranteed_by = GER }
			}
		}
		add_political_power = -40
		FROM = { country_event = { id = italy_shared.74 hours = 5 } }
	}
}

# Italian troops have entered Ticino - crisis moment
country_event = {
	id = italy_shared.74
	title = italy_shared.74.t
	desc = italy_shared.74.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	trigger = {
		NOT = { has_war_with = FROM }
		owns_state = 761
	}
	
	immediate = {
		FROM = { save_event_target_as = aggressor }
	}

	option = {
		name = italy_shared.74.a #Lay down our arms and surrender Ticino to italy_shared
		ai_chance = {
			factor = 10
		}
		add_political_power = -60
		FROM = {
			transfer_state = 761
			country_event = { id = italy_shared.75 days = 1 }
		}
	}
	option = {
		name = italy_shared.74.b #Order our troops to resist the invasion
		ai_chance = {
			factor = 90
		}
		add_political_power = 60
		FROM = { country_event = { id = italy_shared.78 days = 2 } }
		if = {
			limit = {
				tag = SWI
				is_in_faction = no
				NOT = {
					is_guaranteed_by = GER
					has_socialist_government = yes
				}
			}
			GER = { country_event = { id = italy_shared.76 days = 1 } }
		}
		if = {
			limit = {
				tag = SWI
				is_in_faction = no
				NOT = { is_guaranteed_by = GER }
				has_socialist_government = yes
			}
			random_country = {
				limit = {
					capital_scope = { is_on_continent = europe }
					any_neighbor_country = { tag = SWI }
					strength_ratio = { tag = FROM ratio > 0.8 }
					NOT = {
						tag = FROM
						is_in_faction_with = FROM
						has_guaranteed = SWI
					}
					has_socialist_government = yes
				}
				country_event = { id = italy_shared.76 days = 1 }
			}
		}
	}
}

# Ticino has been turned over to italy_shared
country_event = {
	id = italy_shared.75
	title = italy_shared.75.t
	desc = italy_shared.75.d
	picture = GFX_report_event_finnish_letter

	is_triggered_only = yes

	option = {
		name = italy_shared.75.a
		add_political_power = 200
		add_state_core = 761
	}
}

# Major power warned that italy_shared is breaching Switzerland's neutrality
country_event = {
	id = italy_shared.76
	title = italy_shared.76.t
	desc = italy_shared.76.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	trigger = {
		SWI = {
			NOT = { has_war_with = event_target:aggressor }
			NOT = { is_guaranteed_by = ROOT }
			owns_state = 761
		}
	}

	option = {
		name = italy_shared.76.a #This is not of our concern
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0.5
				has_political_power < 0
			}
			modifier = {
				factor = 4
				NOT = { tag = GER }
			}
			modifier = {
				factor = 5
				has_war = yes
			}
			modifier = {
				factor = 5
				is_in_faction_with = event_target:aggressor
			}
		}
		add_political_power = -100
		reverse_add_opinion_modifier = { target = SWI modifier = KR_disapproves_of_govt }
		reverse_add_opinion_modifier = { target = event_target:aggressor modifier = KR_approves_of_govt }
		hidden_effect = {
			random_country = {
				limit = {
					capital_scope = { is_on_continent = europe }
					any_neighbor_country = { tag = SWI }
					strength_ratio = { tag = event_target:aggressor ratio > 0.8 }
					NOT = {
						tag = event_target:aggressor
						is_in_faction_with = event_target:aggressor
						has_guaranteed = SWI
						has_socialist_government = yes
					}
				}
				country_event = { id = italy_shared.76 }
			}
		}
	}
	option = {
		name = italy_shared.76.b #Guarantee Switzerland's borders
		ai_chance = {
			factor = 95
			modifier = {
				factor = 0.75
				NOT = { tag = GER }
			}
		}
		give_guarantee = SWI
		diplomatic_relation = { country = event_target:aggressor relation = guarantee active = no }
		diplomatic_relation = { country = event_target:aggressor relation = non_aggression_pact active = no }
		reverse_add_opinion_modifier = { target = event_target:aggressor modifier = KR_approves_of_govt }
		reverse_add_opinion_modifier = { target = SWI modifier = KR_approves_of_govt }
		event_target:aggressor = { country_event = { id = italy_shared.77 } }
	}
}

# italy_shared is warned that the major power has guaranteed Switzerland
country_event = {
	id = italy_shared.77
	title = italy_shared.77.t
	desc = italy_shared.77.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.77.a #Pull back, we can't risk war with X
		ai_chance = {
			factor = 80
			modifier = {
				factor = 0.25
				FROM = {
					NOT = { tag = GER }
					is_in_faction = no
					strength_ratio = { tag = ROOT ratio < 1.5 }
				}
			}
			modifier = {
				factor = 4
				has_war = yes
			}
		}
		add_political_power = -50
		set_country_flag = ITA_cancel_switzerland
	}
	option = {
		name = italy_shared.77.b #We will not respond to their threats
		ai_chance = {
			factor = 20
			modifier = {
				factor = 4
				FROM = {
					NOT = { tag = GER }
					is_in_faction = no
					strength_ratio = { tag = ROOT ratio < 1.5 }
				}
			}
		}
		if = {
			limit = { is_in_faction_with = FROM }
			remove_from_faction = ROOT
		}
	}
}

# italy_shared must decide whether to begin the war
country_event = {
	id = italy_shared.78
	title = italy_shared.78.t
	desc = italy_shared.78.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	trigger = {
		NOT = { has_country_flag = ITA_cancel_switzerland }
		FROM = {
			NOT = { has_war_with = ROOT }
			owns_state = 761
		}
	}

	option = {
		name = italy_shared.78.a #Pull back, cancel the invasion
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0
				has_political_power < 0
			}
			modifier = {
				factor = 4
				has_war = yes
			}
		}
		add_political_power = -300
	}
	option = {
		name = italy_shared.78.b #Order a general mobilization and declare war
		ai_chance = {
			factor = 80
		}
		add_state_core = 761
		set_country_flag = ITA_ticino_war
		declare_war_on = { target = FROM type = take_core_state }
		if = {
			limit = { FROM = { tag = SWI } }
			add_named_threat = { threat = 5 name = ITA_Irredentism_Tension }
		}
	}
}

# italy_shared informed the referendum will be held in two weeks
country_event = {
	id = italy_shared.79
	title = italy_shared.79.t
	desc = italy_shared.79.d

	is_triggered_only = yes

	option = {
		name = italy_shared.79.a
		add_state_claim = 761
		FROM = { country_event = { id = italy_shared.80 days = 14 } }
	}
}

# The Ticino Referendum
country_event = {
	id = italy_shared.80
	title = italy_shared.80.t
	desc = italy_shared.80.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	trigger = {
		NOT = { has_war_with = FROM }
		owns_state = 761
		controls_state = 761
	}

	option = {
		name = italy_shared.80.a
		if = {
			limit = { tag = SWI }
			random_list = {
				45 = {
					add_political_power = -100
					FROM = {
						transfer_state = 761
						country_event = { id = italy_shared.75 }
					}
				}
				55 = {
					add_political_power = 100
					FROM = { country_event = { id = italy_shared.81 } }
				}
			}
			else = {
				random_list = {
					75 = {
						add_political_power = -100
						FROM = {
							transfer_state = 761
							country_event = { id = italy_shared.75 }
						}
					}
					25 = {
						add_political_power = 100
						FROM = { country_event = { id = italy_shared.81 } }
					}
				}
			}
		}
	}
}

# The Ticino Referendum - Italian Defeat
country_event = {
	id = italy_shared.81
	title = italy_shared.81.t
	desc = italy_shared.81.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.81.a #Respect the results
		add_political_power = -40
	}
	option = {
		name = italy_shared.81.b #Cross the border and seize Ticino
		FROM = { country_event = { id = italy_shared.74 days = 1 } }
	}
}

# The Italians control Ticino - white peace?
country_event = {
	id = italy_shared.82
	title = italy_shared.82.t
	desc = italy_shared.82.d
	picture = GFX_report_event_generic_towar

	fire_only_once = yes

	trigger = {
		OR = {
			AND = {
				has_war_with = ITA
				owns_state = 761
				surrender_progress > 0.1
				ITA = {
					has_country_flag = ITA_ticino_war
					controls_state = 761
					NOT = { surrender_progress > 0.1 }
				}
			}
			AND = {
				has_war_with = SRI
				owns_state = 761
				surrender_progress > 0.1
				SRI = {
					has_country_flag = ITA_ticino_war
					controls_state = 761
					NOT = { surrender_progress > 0.1 }
				}
			}
		}
	}

	mean_time_to_happen = {
		days = 5
	}

	immediate = {
		random_country = {
			limit = { has_country_flag = ITA_ticino_war }
			clr_country_flag = ITA_ticino_war
			save_event_target_as = aggressor
		}
	}

	option = {
		name = italy_shared.82.a #Send the envoys and offer to surrender Ticino
		ai_chance = { factor = 100 }
		add_political_power = -140
		event_target:aggressor = { country_event = { id = italy_shared.83 } }
	}
	option = {
		name = italy_shared.82.b #This war won't stop until we're marching on Rome!
		ai_chance = { factor = 0 }
		add_political_power = -100
	}
}

# Sued for peace: Ticino is surrendered
country_event = {
	id = italy_shared.83
	title = italy_shared.83.t
	desc = italy_shared.83.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.83.a #Yes, let's end this now
		ai_chance = { factor = 75 }
		add_political_power = 100
		FROM = { white_peace_with_ROOT = yes }
		transfer_state = 761
	}
	option = {
		name = italy_shared.83.b #This war won't be over until we're marching on [From.Capital.GetName]!
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				FROM = { NOT = { tag = SWI } }
			}
		}
		add_political_power = -100
	}
}

# The Italians are losing the war - white peace?
country_event = {
	id = italy_shared.84
	title = italy_shared.84.t
	desc = italy_shared.84.d
	picture = GFX_report_event_generic_towar

	fire_only_once = yes

	trigger = {
		OR = {
			tag = ITA
			tag = SRD
			tag = SIC
			tag = PAP
			tag = SRI
		}
		has_war = yes
		surrender_progress > 0.1
		has_country_flag = ITA_ticino_war
		any_enemy_country = {
			has_war_with = ROOT
			owns_state = 761
			controls_state = 761
			NOT = { any_owned_state = { is_controlled_by = ROOT } }
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	immediate = {
		clr_country_flag = ITA_ticino_war
	}

	option = {
		name = italy_shared.82.a #Send the envoys and offer white peace
		ai_chance = { factor = 100 }
		add_political_power = -300
		random_enemy_country = {
			limit = {
				has_war_with = ROOT
				owns_state = 761
				controls_state = 761
				NOT = { any_owned_state = { is_controlled_by = ROOT } }
			}
			country_event = { id = italy_shared.85 }
		}
	}
	option = {
		name = italy_shared.82.b #We can still win this!
		ai_chance = { factor = 0 }
		add_political_power = -200
	}
}

# Sued for peace: white peace with italy_shared?
country_event = {
	id = italy_shared.85
	title = italy_shared.85.t
	desc = italy_shared.85.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.83.a #Yes, let's end this now
		ai_chance = { factor = 75 }
		add_political_power = 200
		FROM = { white_peace_with_ROOT = yes }
	}
	option = {
		name = italy_shared.83.b #This war won't be over until we're marching on [From.Capital.GetName]!
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				tag = SWI
			}
		}
		add_political_power = -100
	}
}

### MALTA EVENTS

# italy_shared offers to buy Malta
country_event = {
	id = italy_shared.90
	title = italy_shared.90.t
	desc = italy_shared.90.d
	picture = GFX_report_event_MLT_aoe

	is_triggered_only = yes

	immediate = {
		random_country = {
			limit = {
				owns_state = 116
				is_subject_of = ROOT
			}
			save_event_target_as = puppet_owner
		}
	}

	option = {
		name = italy_shared.90.a #Accept their offer, we don't need Malta that much anymore
		ai_chance = {
			factor = 5
			modifier = {
				factor = 5
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 2
				has_opinion = { target = FROM value > 20 }
			}
			modifier = {
				factor = 2
				has_opinion = { target = FROM value > 50 }
			}
			modifier = {
				factor = 0
				has_opinion = { target = FROM value < -20 }
			}
		}
		add_political_power = -50
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = ITA_sold_us_malta }
			effect_tooltip = {
				send_equipment = { target = ROOT type = infantry_equipment amount = 1000 }
				diplomatic_relation = { country = ROOT relation = non_aggression_pact }
				if = {
					limit = { NOT = { gives_military_access_to = ROOT } }
					ROOT = { give_military_access = PREV }
				}
				if = {
					limit = { event_target:puppet_owner = { owns_state = 116 } }
					puppet = event_target:puppet_owner
					else = { transfer_state = 116 } #Malta
				}
			}
			country_event = italy_shared.91
		}
	}
	option = {
		name = italy_shared.90.b #They're joking, right?
		ai_chance = {
			factor = 95
			modifier = {
				factor = 0.5
				FROM = { gives_military_access_to = ROOT }
			}
		}
		add_political_power = 20
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = KR_hates_govt }
			diplomatic_relation = { country = ROOT relation = non_aggression_pact active = no }
			if = {
				limit = { gives_military_access_to = ROOT }
				diplomatic_relation = { country = ROOT relation = military_access active = no }
			}
			country_event = italy_shared.92
		}
	}
}

# Malta has been bought
country_event = {
	id = italy_shared.91
	title = italy_shared.91.t
	desc = italy_shared.91.d
	picture = GFX_report_event_MLT_aoe

	is_triggered_only = yes

	option = {
		name = italy_shared.91.a
		send_equipment = { target = FROM type = infantry_equipment amount = 1000 }
		diplomatic_relation = { country = FROM relation = non_aggression_pact }
		if = {
			limit = { NOT = { gives_military_access_to = FROM } }
			FROM = { give_military_access = ROOT }
		}
		if = {
			limit = { event_target:puppet_owner = { owns_state = 116 } }
			puppet = event_target:puppet_owner
			event_target:puppet_owner = { country_event = italy_shared.141 }
			else = { transfer_state = 116 } #Malta
		}
	}
}

# Malta's sale has been refused
country_event = {
	id = italy_shared.92
	title = italy_shared.92.t
	desc = italy_shared.92.d
	picture = GFX_report_event_MLT_aoe

	is_triggered_only = yes

	option = {
		name = italy_shared.92.a #Threaten them with war
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				OR = {
					has_socialist_government = yes
					has_government = national_populist
				}
			}
			modifier = {
				factor = 0.1
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 0.25
				is_in_faction = no
				FROM = {
					has_war = no
					OR = {
						is_in_faction = yes
						strength_ratio = { tag = ROOT ratio > 1.5 }
					}
				}
			}
		}
		if = {
			limit = { is_in_faction_with = FROM }
			remove_from_faction = ROOT
		}
		add_political_power = -60
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = ITA_outraged }
			country_event = { id = italy_shared.93 hours = 3 }
		}
	}
	option = {
		name = italy_shared.92.b #It is too risky...
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0.3
				strength_ratio = { tag = FROM ratio > 1.0 }
			}
			modifier = {
				factor = 0.3
				strength_ratio = { tag = FROM ratio > 1.5 }
			}
			modifier = {
				factor = 0.5
				FROM = { has_war = yes }
			}
		}
		add_political_power = -40
	}
}

# italy_shared makes an ultimatum: turn over Malta or else...
country_event = {
	id = italy_shared.93
	title = italy_shared.93.t
	desc = italy_shared.93.d
	picture = GFX_report_event_MLT_aoe

	is_triggered_only = yes

	trigger = {
		OR = {
			owns_state = 116
			any_country = {
				owns_state = 116
				is_subject_of = ROOT
			}
		}
	}

	option = {
		name = italy_shared.93.a #Right, right, we don't even need Malta that much anyway...
		ai_chance = {
			factor = 5
			modifier = {
				factor = 5
				has_war = yes
				surrender_progress > 0.20
			}
		}
		add_political_power = -200
		FROM = {
			effect_tooltip = {
				if = {
					limit = { event_target:puppet_owner = { owns_state = 116 } }
					puppet = event_target:puppet_owner
					else = { transfer_state = 116 } #Malta
				}
			}
			country_event = { id = italy_shared.94 hours = 3 }
		}
	}
	option = {
		name = italy_shared.93.b #Such insolence will be punished!
		ai_chance = {
			factor = 95
			modifier = {
				factor = 0.5
				has_war = yes
			}
			modifier = {
				factor = 0.5
				strength_ratio = { tag = FROM ratio < 0.75 }
			}
		}
		FROM = { set_country_flag = ITA_malta_war }
		add_political_power = 100
		diplomatic_relation = { country = FROM relation = non_aggression_pact active = no }
		declare_war_on = {
			target = FROM
			type = annex_everything
		}
	}
}

# The ultimatum succeeds: Malta is surrendered
country_event = {
	id = italy_shared.94
	title = italy_shared.94.t
	desc = italy_shared.94.d
	picture = GFX_report_event_MLT_aoe

	is_triggered_only = yes

	option = {
		name = italy_shared.94.a
		add_political_power = 100
		if = {
			limit = { event_target:puppet_owner = { owns_state = 116 } }
			puppet = event_target:puppet_owner
			event_target:puppet_owner = { country_event = italy_shared.141 }
			else = { transfer_state = 116 } #Malta
		}
	}
}

# italy_shared has taken Malta - white peace?
country_event = {
	id = italy_shared.95
	title = italy_shared.95.t
	desc = italy_shared.95.d
	picture = GFX_report_event_generic_towar

	fire_only_once = yes

	trigger = {
		has_war = yes
		surrender_progress > 0.10
		OR = {
			owns_state = 116
			MLT = {
				owns_state = 116
				is_subject_of = ROOT
			}
		}
		any_enemy_country = {
			has_war_with = ROOT
			has_country_flag = ITA_malta_war
			controls_state = 116
			NOT = { surrender_progress > 0.2 }
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	immediate = {
		random_enemy_country = {
			limit = { has_country_flag = ITA_malta_war }
			clr_country_flag = ITA_malta_war
			save_event_target_as = aggressor
		}
		random_country = {
			limit = {
				owns_state = 116
				is_subject_of = ROOT
			}
			save_event_target_as = puppet_owner
		}
	}

	option = {
		name = italy_shared.95.a #Pull back our forces, sign a peace treaty and cede Malta to the Italians
		ai_chance = {
			factor = 70
			modifier = {
				factor = 1.5
				event_target:aggressor = { NOT = { surrender_progress > 0.05 } }
			}
		}
		add_political_power = -100
		event_target:aggressor = { country_event = { id = italy_shared.96 } }
	}
	option = {
		name = italy_shared.95.b #This war won't be over until we're marching on Rome!
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.5
				event_target:aggressor = { NOT = { surrender_progress > 0.05 } }
			}
		}
		add_political_power = -200
	}
}

# Sued for peace: Malta is surrendered
country_event = {
	id = italy_shared.96
	title = italy_shared.96.t
	desc = italy_shared.96.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.96.a #Yes, let's end this now
		ai_chance = { factor = 100 }
		add_political_power = 100
		FROM = { white_peace_with_ROOT = yes }
		if = {
			limit = { event_target:puppet_owner = { owns_state = 116 } }
			event_target:puppet_owner = { white_peace_with_ROOT = yes }
			puppet = event_target:puppet_owner
			else = { transfer_state = 116 } #Malta
		}
	}
	option = {
		name = italy_shared.96.b #This war won't be over until we're marching on [From.Capital.GetName]!
		ai_chance = { factor = 0 }
		add_political_power = -100
	}
}

# Malta is integrated into italy_shared
country_event = {
	id = italy_shared.97
	title = italy_shared.97.t
	desc = italy_shared.97.d
	picture = GFX_report_event_malta

	fire_only_once = yes

	trigger = {
		OR = {
			tag = ITA
			tag = SRD
			tag = SIC
			tag = PAP
			tag = SRI
		}
		controls_state = 116
		116 = { NOT = { is_core_of = ROOT } }
		has_war = no
	}

	mean_time_to_happen = {
		months = 12
		modifier = {
			factor = 0.5
			116 = { is_claimed_by = ROOT }
		}
	}

	option = {
		name = italy_shared.97.a
		clr_country_flag = ITA_malta_war
		add_political_power = -50
		add_state_core = 116
	}
}

# italy_shared failed to take Malta in the war
country_event = {
	id = italy_shared.98
	title = italy_shared.98.t
	desc = italy_shared.98.d
	picture = GFX_report_event_malta

	fire_only_once = yes

	trigger = {
		OR = {
			tag = ITA
			tag = SRD
			tag = SIC
			tag = PAP
			tag = SRI
		}
		has_country_flag = ITA_malta_war
		has_war = no
		NOT = {
			owns_state = 116
			any_country = {
				is_subject_of = ROOT
				owns_state = 116
			}
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	option = {
		name = italy_shared.98.a
		clr_country_flag = ITA_malta_war
		add_political_power = -100
	}
}

### TUNISIA EVENTS

# italy_shared offers to buy Tunisia
country_event = {
	id = italy_shared.100
	title = italy_shared.100.t
	desc = italy_shared.100.d
	picture = GFX_LBA_Camel3

	is_triggered_only = yes

	immediate = {
		random_country = {
			limit = {
				owns_state = 458
				is_subject_of = ROOT
			}
			save_event_target_as = puppet_owner
		}
	}

	option = {
		name = italy_shared.100.a #Accept their offer and give them Tunisia
		ai_chance = {
			factor = 10
			modifier = {
				factor = 5
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 2
				has_opinion = { target = FROM value > 20 }
			}
			modifier = {
				factor = 2
				has_opinion = { target = FROM value > 50 }
			}
			modifier = {
				factor = 0
				has_opinion = { target = FROM value < -20 }
			}
			modifier = {
				factor = 0
				458 = { is_core_of = ROOT }
			}
			modifier = {
				factor = 0
				has_government = national_populist
			}
			modifier = {
				factor = 0
				has_socialist_government = yes
				FROM = { NOT = { has_socialist_government = yes } }
			}
			modifier = {
				factor = 0
				NOT = { has_socialist_government = yes }
				FROM = { has_socialist_government = yes }
			}
		}
		add_political_power = -100
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = ITA_sold_us_tunisia }
			effect_tooltip = {
				send_equipment = { target = ROOT type = infantry_equipment amount = 2500 }
				diplomatic_relation = { country = ROOT relation = non_aggression_pact }
				if = {
					limit = { NOT = { gives_military_access_to = ROOT } }
					ROOT = { give_military_access = PREV }
				}
				if = {
					limit = { event_target:puppet_owner = { owns_state = 458 } }
					puppet = event_target:puppet_owner
				}
				if = {
					limit = { ROOT = { owns_state = 458 } }
					transfer_state = 458
				}
				if = {
					limit = { ROOT = { owns_state = 665 } }
					transfer_state = 665
				}
			}
			country_event = { id = italy_shared.101 }
		}
	}
	option = {
		name = italy_shared.100.b #They're joking, right?
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0.5
				FROM = { gives_military_access_to = ROOT }
			}
		}
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = ITA_hates_govt }
			diplomatic_relation = { country = ROOT relation = non_aggression_pact active = no }
			if = {
				limit = { gives_military_access_to = ROOT }
				diplomatic_relation = { country = ROOT relation = military_access active = no }
			}
			country_event = { id = italy_shared.102 }
		}
	}
}

# Tunisia has been bought
country_event = {
	id = italy_shared.101
	title = italy_shared.101.t
	desc = italy_shared.101.d
	picture = GFX_LBA_Camel3

	is_triggered_only = yes

	option = {
		name = italy_shared.101.a
		send_equipment = { target = FROM type = infantry_equipment amount = 2500 }
		diplomatic_relation = { country = FROM relation = non_aggression_pact }
		if = {
			limit = { NOT = { gives_military_access_to = FROM } }
			FROM = { give_military_access = ROOT }
		}
		if = {
			limit = { event_target:puppet_owner = { owns_state = 458 } }
			puppet = event_target:puppet_owner
			event_target:puppet_owner = { country_event = italy_shared.141 }
		}
		if = {
			limit = { FROM = { owns_state = 458 } } #Tunisia
			transfer_state = 458
		}
		if = {
			limit = { FROM = { owns_state = 665 } } #Gabes
			transfer_state = 665
		}
	}
}

# Tunisia's sale has been refused
country_event = {
	id = italy_shared.102
	title = italy_shared.102.t
	desc = italy_shared.102.d
	picture = GFX_LBA_Camel3

	is_triggered_only = yes

	option = {
		name = italy_shared.102.a #Threaten them with war
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				OR = {
					has_socialist_government = yes
					has_government = national_populist
				}
			}
			modifier = {
				factor = 0.1
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 0.25
				is_in_faction = no
				FROM = {
					has_war = no
					OR = {
						is_in_faction = yes
						strength_ratio = { tag = ROOT ratio > 1.5 }
					}
				}
			}
		}
		if = {
			limit = { is_in_faction_with = FROM }
			remove_from_faction = ROOT
		}
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = ITA_outraged }
			country_event = { id = italy_shared.103 hours = 3 }
		}
	}
	option = {
		name = italy_shared.102.b #It is too risky...
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0.3
				strength_ratio = { tag = FROM ratio > 1.0 }
			}
			modifier = {
				factor = 0.3
				strength_ratio = { tag = FROM ratio > 1.5 }
			}
			modifier = {
				factor = 0.5
				FROM = { has_war = yes }
			}
		}
		add_political_power = -100
	}
}

# italy_shared makes an ultimatum: turn over Tunisia or else...
country_event = {
	id = italy_shared.103
	title = italy_shared.103.t
	desc = italy_shared.103.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	trigger = {
		OR = {
			owns_state = 458
			any_country = {
				owns_state = 458
				is_subject_of = ROOT
			}
		}
	}

	option = {
		name = italy_shared.103.a #Right, right, we don't even need Tunisia that much anyway...
		ai_chance = {
			factor = 5
			modifier = {
				factor = 5
				has_war = yes
				surrender_progress > 0.20
			}
		}
		add_political_power = -300
		FROM = {
			effect_tooltip = {
				if = {
					limit = { event_target:puppet_owner = { owns_state = 458 } }
					puppet = event_target:puppet_owner
				}
				if = {
					limit = { ROOT = { owns_state = 458 } }
					transfer_state = 458
				}
				if = {
					limit = { ROOT = { owns_state = 665 } }
					transfer_state = 665
				}
			}
			country_event = { id = italy_shared.104 hours = 3 }
		}
	}
	option = {
		name = italy_shared.103.b #Such insolence will be punished!
		ai_chance = {
			factor = 95
			modifier = {
				factor = 0.5
				has_war = yes
			}
			modifier = {
				factor = 0.5
				strength_ratio = { tag = FROM ratio < 0.75 }
			}
		}
		FROM = { set_country_flag = ITA_tunisia_war }
		add_political_power = 100
		diplomatic_relation = { country = FROM relation = non_aggression_pact active = no }
		declare_war_on = {
			target = FROM
			type = annex_everything
		}
	}
}

# The ultimatum succeeds: Tunisia is surrendered
country_event = {
	id = italy_shared.104
	title = italy_shared.104.t
	desc = italy_shared.104.d
	picture = GFX_LBA_Camel3

	is_triggered_only = yes

	option = {
		name = italy_shared.104.a
		add_political_power = 100
		if = {
			limit = { event_target:puppet_owner = { owns_state = 458 } }
			puppet = event_target:puppet_owner
			event_target:puppet_owner = { country_event = italy_shared.141 }
		}
		if = {
			limit = { FROM = { owns_state = 458 } }
			transfer_state = 458
		}
		if = {
			limit = { FROM = { owns_state = 665 } }
			transfer_state = 665
		}
	}
}

# italy_shared has taken Malta - white peace?
country_event = {
	id = italy_shared.105
	title = italy_shared.105.t
	desc = italy_shared.105.d
	picture = GFX_report_event_generic_towar

	fire_only_once = yes

	trigger = {
		has_war = yes
		surrender_progress > 0.10
		OR = {
			owns_state = 458
			any_country = {
				owns_state = 458
				is_subject_of = ROOT
			}
		}
		any_enemy_country = {
			has_war_with = ROOT
			NOT = { surrender_progress > 0.1 }
			has_country_flag = ITA_tunisia_war
			controls_state = 458
			OR = {
				controls_state = 665
				NOT = {
					ROOT = { owns_state = 665 }
					any_country = {
						owns_state = 665
						is_subject_of = ROOT
					}
				}
			}
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	immediate = {
		random_enemy_country = {
			limit = { has_country_flag = ITA_tunisia_war }
			clr_country_flag = ITA_tunisia_war
			save_event_target_as = aggressor
		}
		random_country = {
			limit = {
				owns_state = 458
				is_subject_of = ROOT
			}
			save_event_target_as = puppet_owner
		}
	}

	option = {
		name = italy_shared.105.a #Pull back our forces, sign a peace treaty and cede Tunisia to the Italians
		ai_chance = {
			factor = 70
			modifier = {
				factor = 1.5
				event_target:aggressor = { NOT = { surrender_progress > 0.05 } }
			}
		}
		add_political_power = -200
		event_target:aggressor = { country_event = { id = italy_shared.106 } }
	}
	option = {
		name = italy_shared.105.b #This war won't be over until we're marching on Rome!
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.5
				event_target:aggressor = { NOT = { surrender_progress > 0.05 } }
			}
		}
		add_political_power = -300
	}
}

# Sued for peace: Tunisia is surrendered
country_event = {
	id = italy_shared.106
	title = italy_shared.106.t
	desc = italy_shared.106.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.106.a #Yes, let's end this now
		ai_chance = { factor = 100 }
		add_political_power = 100
		FROM = { white_peace_with_ROOT = yes }
		if = {
			limit = { event_target:puppet_owner = { owns_state = 458 } }
			event_target:puppet_owner = { white_peace_with_ROOT = yes }
			puppet = event_target:puppet_owner
		}
		if = {
			limit = { FROM = { owns_state = 458 } }
			transfer_state = 458
		}
		if = {
			limit = { FROM = { owns_state = 665 } }
			transfer_state = 665
		}
	}
	option = {
		name = italy_shared.106.b #This war won't be over until we're marching on [From.Capital.GetName]!
		ai_chance = { factor = 0 }
		add_political_power = -100
	}
}

# Tunisia is integrated into italy_shared
country_event = {
	id = italy_shared.107
	title = italy_shared.107.t
	desc = italy_shared.107.d
	picture = GFX_LBA_Camel3

	fire_only_once = yes

	trigger = {
		OR = {
			tag = ITA
			tag = SRD
			tag = SIC
			tag = PAP
			tag = SRI
		}
		owns_state = 458
		458 = { NOT = { is_core_of = ROOT } }
		has_war = no
	}

	mean_time_to_happen = {
		months = 12
		modifier = {
			factor = 0.5
			458 = { is_claimed_by = ROOT }
		}
	}

	immediate = { clr_country_flag = ITA_tunisia_war }

	option = {
		name = italy_shared.107.a #Integrate Tunisia into italy_shared proper
		ai_chance = { factor = 5 }
		add_political_power = -50
		add_state_core = 458
		if = {
			limit = { owns_state = 665 }
			add_state_core = 665
		}
	}
	option = {
		name = italy_shared.107.b #Create Italian Tunisia
		trigger = { NOT = { country_exists = TUN } }
		ai_chance = { factor = 50 }
		add_political_power = 100
		every_state = {
			limit = {
				is_core_of = TUN
				is_owned_by = ROOT
			}
			ROOT = { remove_state_claim = PREV }
			TUN = { transfer_state = PREV }
		}
		puppet = TUN

	}
	option = {
		name = italy_shared.107.c #Make Tunisia part of Italian North Africa
		trigger = {
			owns_state = 665
			LBA = {
				is_subject_of = ROOT
				owns_state = 448
			}
		}
		ai_chance = { factor = 50 }
		add_political_power = 100
		every_state = {
			limit = {
				is_core_of = TUN
				is_owned_by = ROOT
			}
			ROOT = { remove_state_claim = PREV }
			LBA = {
				add_state_core = PREV
				transfer_state = PREV
			}
		}
	}
}

# italy_shared failed to take Tunisia in the war
country_event = {
	id = italy_shared.108
	title = italy_shared.108.t
	desc = italy_shared.108.d
	picture = GFX_LBA_Camel3

	fire_only_once = yes

	trigger = {
		OR = {
			tag = ITA
			tag = SRD
			tag = SIC
			tag = PAP
			tag = SRI
		}
		has_country_flag = ITA_tunisia_war
		has_war = no
		NOT = {
			owns_state = 458
			any_country = {
				is_subject_of = ROOT
				owns_state = 458
			}
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	option = {
		name = italy_shared.108.a
		clr_country_flag = ITA_tunisia_war
		add_political_power = -100
	}
}

### NORTHEAST italy_shared EVENTS

# italy_shared demands an Austrian referendum in Italian provinces
country_event = {
	id = italy_shared.110
	title = italy_shared.110.t
	desc = italy_shared.110.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.110.a #They must be joking, right?
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0.5
				is_in_faction_with = FROM
			}
		}
		add_opinion_modifier = { target = FROM modifier = KR_outraged }
		FROM = { country_event = { id = italy_shared.111 } }
	}
	option = {
		name = italy_shared.110.b #Accept their proposal, call up a referendum on the matter
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0.1
				has_political_power < 0
			}
			modifier = {
				factor = 3
				NOT = {
					has_socialist_government = yes
					has_authoritarian_government = yes
				}
			}
			modifier = {
				factor = 1.5
				OR = {
					has_government = social_liberal
					has_government = market_liberal
				}
			}
		}
		every_owned_state = {
			limit = { is_core_of = FROM }
			custom_effect_tooltip = ITA_referendum_possible
		}
		add_opinion_modifier = { target = FROM modifier = KR_disapproves_of_govt }
		add_political_power = -200
		FROM = { country_event = { id = italy_shared.113 } }
	}
}

# Austria refuses to hold the referendum
country_event = {
	id = italy_shared.111
	title = italy_shared.111.t
	desc = italy_shared.111.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.111.a #Forget about this matter, just present our territorial claims instead
		ai_chance = {
			factor = 60
			modifier = {
				factor = 1.5
				NOT = {
					has_socialist_government = yes
					has_government = national_populist
				}
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio < 1.0 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio < 0.75 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio < 0.5 }
			}
		}
		add_opinion_modifier = { target = AUS modifier = KR_disapproves_of_govt }
		add_political_power = -80
	}
	option = {
		name = italy_shared.111.b #Threaten them with war if they do not hold the referendum
		ai_chance = {
			factor = 40
			modifier = {
				factor = 0
				OR = {
					has_opinion = { target = AUS value > 20 }
					is_in_faction_with = AUS
				}
			}
			modifier = {
				factor = 0
				AUS = { is_in_faction = yes }
				is_in_faction = no
			}
			modifier = {
				factor = 2
				AUS = { is_in_faction = no }
				is_in_faction = yes
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio > 1.0 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio > 1.5 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio > 2.0 }
			}
		}
		if = {
			limit = { is_in_faction_with = AUS }
			remove_from_faction = ROOT
		}
		add_opinion_modifier = { target = AUS modifier = ITA_outraged }
		diplomatic_relation = { country = AUS relation = non_aggression_pact active = no }
		if = {
			limit = { gives_military_access_to = AUS }
			diplomatic_relation = { country = AUS relation = military_access active = no }
		}
		AUS = { country_event = { id = italy_shared.112 days = 5 } }
	}
}

# italy_shared issues an ultimatum: perform the referendum, or else
country_event = {
	id = italy_shared.112
	title = italy_shared.112.t
	desc = italy_shared.112.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.112.a #Very well, the referendum will take place
		ai_chance = {
			factor = 30
			modifier = {
				factor = 1.5
				has_war = yes
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = FROM ratio < 1.0 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = FROM ratio < 0.75 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = FROM ratio < 0.5 }
			}
		}
		add_political_power = -300
		every_owned_state = {
			limit = { is_core_of = FROM }
			custom_effect_tooltip = ITA_referendum_possible
		}
		FROM = { country_event = { id = italy_shared.113 } }
	}
	option = {
		name = italy_shared.112.b #We must attack them first! Declare war!
		ai_chance = {
			factor = 70
			modifier = {
				factor = 2
				is_in_faction = yes
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = FROM ratio > 1.0 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = FROM ratio > 1.5 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = FROM ratio > 2.0 }
			}
		}
		diplomatic_relation = { country = FROM relation = non_aggression_pact active = no }
		if = {
			limit = { gives_military_access_to = FROM }
			diplomatic_relation = { country = FROM relation = military_access active = no }
		}
		FROM = { set_country_flag = ITA_austrian_war }
		declare_war_on = {
			target = FROM
			type = annex_everything
		}
	}
}

# italy_shared informed the Austrian referendum will be held in two weeks
country_event = {
	id = italy_shared.113
	title = italy_shared.113.t
	desc = italy_shared.113.d

	is_triggered_only = yes

	option = {
		name = italy_shared.113.a
		add_political_power = 100
		add_opinion_modifier = { target = AUS modifier = ITA_likes_govt }
		AUS = { country_event = { id = italy_shared.114 days = 14 } }
	}
}

# The Austrian Referendum
country_event = {
	id = italy_shared.114
	title = italy_shared.114.t
	desc = italy_shared.114.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.114.a
		random_list = {
			50 = {
				add_political_power = 100
				FROM = { country_event = { id = italy_shared.115 } }
			}
			50 = {
				add_political_power = -100
				FROM = { country_event = { id = italy_shared.116 } }
			}
		}
	}
}

# The Austrian Referendum - Italian Defeat
country_event = {
	id = italy_shared.115
	title = italy_shared.115.t
	desc = italy_shared.115.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.115.a #Respect the results
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0.5
				OR = {
					has_socialist_government = yes
					has_government = national_populist
				}
			}
			modifier = {
				factor = 1.2
				strength_ratio = { tag = AUS ratio < 1.0 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio < 0.75 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio < 0.5 }
			}
		}
		add_political_power = -100
	}
	option = {
		name = italy_shared.115.b #Declare war and take the territories by force!
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0
				AUS = { is_in_faction = yes }
				is_in_faction = no
			}
			modifier = {
				factor = 2
				AUS = { is_in_faction = no }
				is_in_faction = yes
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio > 1.0 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio > 1.5 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = AUS ratio > 2.0 }
			}
		}
		set_country_flag = ITA_austrian_war
		declare_war_on = {
			target = AUS
			type = take_core_state
		}
	}
}

# The Austrian Referendum - Italian Success
country_event = {
	id = italy_shared.116
	title = italy_shared.116.t
	desc = italy_shared.116.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.116.a #Huzzah!
		FROM = {
			every_owned_state = {
				limit = { 
					OR = {
						is_core_of = ROOT 
						is_claimed_by = ROOT 
					}
				}
				if = {
					limit = { is_core_of = AUS }
					AUS = { remove_state_core = PREV }
				}
				ROOT = { transfer_state = PREV }
			}
		}
	}
}

# italy_shared has taken South Austria - white peace?
country_event = {
	id = italy_shared.117
	title = italy_shared.117.t
	desc = italy_shared.117.d
	picture = GFX_report_event_generic_towar

	fire_only_once = yes

	trigger = {
		OR = {
			has_war_with = ITA
			has_war_with = SRI
			has_war_with = SRD
			has_war_with = PAP
			has_war_with = SIC
		}
		OR = {
			AND = {
				has_war_with = ITA
				surrender_progress > 0.20
				ITA = {
					NOT = { surrender_progress > 0.20 }
					has_country_flag = ITA_austrian_war
				}
				any_owned_state = { is_core_of = ITA }
				NOT = {
					any_owned_state = {
						is_core_of = ITA
						is_controlled_by = ROOT
					}
				}
			}
			AND = {
				has_war_with = SRI
				surrender_progress > 0.20
				SRI = {
					NOT = { surrender_progress > 0.20 }
					has_country_flag = ITA_austrian_war
				}
				any_owned_state = { is_core_of = SRI }
				NOT = {
					any_owned_state = {
						is_core_of = SRI
						is_controlled_by = ROOT
					}
				}
			}
			AND = {
				has_war_with = SRD
				surrender_progress > 0.20
				SRD = {
					NOT = { surrender_progress > 0.20 }
					has_country_flag = ITA_austrian_war
				}
				any_owned_state = { is_core_of = SRD }
				NOT = {
					any_owned_state = {
						is_core_of = SRD
						is_controlled_by = ROOT
					}
				}
			}
			AND = {
				has_war_with = PAP
				surrender_progress > 0.20
				PAP = {
					NOT = { surrender_progress > 0.20 }
					has_country_flag = ITA_austrian_war
				}
				any_owned_state = { is_core_of = PAP }
				NOT = {
					any_owned_state = {
						is_core_of = PAP
						is_controlled_by = ROOT
					}
				}
			}
			AND = {
				has_war_with = SIC
				surrender_progress > 0.20
				SIC = {
					NOT = { surrender_progress > 0.20 }
					has_country_flag = ITA_austrian_war
				}
				any_owned_state = { is_core_of = SIC }
				NOT = {
					any_owned_state = {
						is_core_of = SIC
						is_controlled_by = ROOT
					}
				}
			}
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	immediate = {
		random_enemy_country = {
			limit = { has_country_flag = ITA_austrian_war }
			clr_country_flag = ITA_austrian_war
			save_event_target_as = aggressor
		}
	}

	option = {
		name = italy_shared.117.a #Sign a peace treaty and cede all disputed territory to the Italians
		ai_chance = { factor = 90 }
		add_political_power = -100
		event_target:aggressor = { country_event = { id = italy_shared.118 } }
	}
	option = {
		name = italy_shared.117.b #This war won't be over until we're marching on Rome!
		ai_chance = { factor = 10 }
		add_political_power = 100
	}
}

# Sued for peace: South Austria is surrendered
country_event = {
	id = italy_shared.118
	title = italy_shared.118.t
	desc = italy_shared.118.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.118.a #Yes, let's end this now
		ai_chance = { factor = 100 }
		add_political_power = 100
		FROM = {
			white_peace_with_ROOT = yes
			every_owned_state = {
				limit = { 
					OR = {
						is_core_of = ROOT 
						is_claimed_by = ROOT 
					}
				}
				if = {
					limit = { is_core_of = AUS }
					AUS = { remove_state_core = PREV }
				}
				ROOT = { transfer_state = PREV }
			}
		}
	}
	option = {
		name = italy_shared.118.b #This war won't be over until we're marching on [From.Capital.GetName]!
		ai_chance = { factor = 0 }
		add_political_power = -100
	}
}

# Austria is winning - white peace?
country_event = {
	id = italy_shared.119
	title = italy_shared.119.t
	desc = italy_shared.119.d
	picture = GFX_report_event_generic_towar

	fire_only_once = yes

	trigger = {
		OR = {
			tag = ITA
			tag = SRD
			tag = SIC
			tag = PAP
			tag = SRI
		}
		has_country_flag = ITA_austrian_war
		has_war_with = AUS
		surrender_progress > 0.20
		AUS = {
			NOT = {
				surrender_progress > 0.10
				any_owned_state = {
					is_core_of = ROOT
					is_controlled_by = ROOT
				}
			}
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	immediate = {
		clr_country_flag = ITA_austrian_war
	}

	option = {
		name = italy_shared.119.a #Sign a peace treaty and give up all our claims
		ai_chance = { factor = 90 }
		add_political_power = -100
		AUS = { country_event = { id = italy_shared.120 } }
	}
	option = {
		name = italy_shared.119.b #This war won't be over until we're marching on Vienna!
		ai_chance = { factor = 10 }
		add_political_power = 100
	}
}

# Sued for peace: italy_shared gives up claims
country_event = {
	id = italy_shared.120
	title = italy_shared.120.t
	desc = italy_shared.120.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.120.a #Yes, let's end this now
		ai_chance = { factor = 100 }
		add_political_power = 100
		FROM = { white_peace_with_ROOT = yes }
		every_owned_state = {
			limit = { is_core_of = FROM }
			remove_core_of = FROM
		}
		every_owned_state = {
			limit = { is_claimed_by = FROM }
			remove_claim_by = FROM
		}
	}
	option = {
		name = italy_shared.120.b #This war won't be over until we're marching on [From.Capital.GetName]!
		ai_chance = { factor = 0 }
		add_political_power = -100
	}
}

# italy_shared failed to take South Austria in the war
country_event = {
	id = italy_shared.121
	title = italy_shared.121.t
	desc = italy_shared.121.d

	fire_only_once = yes

	trigger = {
		OR = {
			tag = ITA
			tag = SRD
			tag = SIC
			tag = PAP
			tag = SRI
		}
		has_country_flag = ITA_austrian_war
		has_war = no
		AUS = { any_owned_state = { is_core_of = ROOT } }
	}

	mean_time_to_happen = {
		days = 30
	}

	option = {
		name = italy_shared.121.a
		clr_country_flag = ITA_austrian_war
		add_political_power = -100
	}
}

# LIBYA EVENTS

# italy_shared offers to buy Libya
country_event = {
	id = italy_shared.130
	title = italy_shared.130.t
	desc = italy_shared.130.d
	picture = GFX_LBA_Timbuktu

	is_triggered_only = yes

	immediate = {
		random_country = {
			limit = {
				owns_state = 448 #Tripoli
				is_subject_of = ROOT
			}
			save_event_target_as = puppet_owner
		}
	}

	option = {
		name = italy_shared.130.a #Accept their offer and give them Libya
		ai_chance = {
			factor = 10
			modifier = {
				factor = 5
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 2
				has_opinion = { target = FROM value > 20 }
			}
			modifier = {
				factor = 2
				has_opinion = { target = FROM value > 50 }
			}
			modifier = {
				factor = 0
				has_opinion = { target = FROM value < -20 }
			}
			modifier = {
				factor = 0
				458 = { is_core_of = ROOT }
			}
			modifier = {
				factor = 0
				has_government = national_populist
			}
			modifier = {
				factor = 0
				has_socialist_government = yes
				FROM = { NOT = { has_socialist_government = yes } }
			}
			modifier = {
				factor = 0
				NOT = { has_socialist_government = yes }
				FROM = { has_socialist_government = yes }
			}
		}
		add_political_power = -100
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = ITA_sold_us_libya }
			effect_tooltip = {
				send_equipment = { target = ROOT type = infantry_equipment amount = 2500 }
				diplomatic_relation = { country = ROOT relation = non_aggression_pact }
				if = {
					limit = { NOT = { gives_military_access_to = ROOT } }
					ROOT = { give_military_access = PREV }
				}
				if = {
					limit = { event_target:puppet_owner = { owns_state = 448 } }
					puppet = event_target:puppet_owner
				}
				ROOT = {
					every_owned_state = {
						limit = { is_core_of = LBA }
						FROM = { transfer_state = PREV }
					}
				}
			}
			country_event = { id = italy_shared.131 }
		}
	}
	option = {
		name = italy_shared.130.b #They're joking, right?
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0.5
				FROM = { gives_military_access_to = ROOT }
			}
		}
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = ITA_hates_govt }
			diplomatic_relation = { country = ROOT relation = non_aggression_pact active = no }
			if = {
				limit = { gives_military_access_to = ROOT }
				diplomatic_relation = { country = ROOT relation = military_access active = no }
			}
			country_event = { id = italy_shared.132 }
		}
	}
}

# Libya has been bought
country_event = {
	id = italy_shared.131
	title = italy_shared.131.t
	desc = italy_shared.131.d
	picture = GFX_LBA_Camel2

	is_triggered_only = yes

	option = {
		name = italy_shared.131.a
		send_equipment = { target = FROM type = infantry_equipment amount = 2500 }
		diplomatic_relation = { country = FROM relation = non_aggression_pact }
		if = {
			limit = { NOT = { gives_military_access_to = FROM } }
			FROM = { give_military_access = ROOT }
		}
		if = {
			limit = { event_target:puppet_owner = { owns_state = 448 } }
			puppet = event_target:puppet_owner
			event_target:puppet_owner = { country_event = italy_shared.141 }
		}
		FROM = {
			every_owned_state = {
				limit = { is_core_of = LBA }
				ROOT = { transfer_state = PREV }
			}
		}
	}
}

# Libya's sale has been refused
country_event = {
	id = italy_shared.132
	title = italy_shared.132.t
	desc = italy_shared.132.d
	picture = GFX_LBA_Camel2

	is_triggered_only = yes

	option = {
		name = italy_shared.132.a #Threaten them with war
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				OR = {
					has_socialist_government = yes
					has_government = national_populist
				}
			}
			modifier = {
				factor = 0.1
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 0.25
				is_in_faction = no
				FROM = {
					has_war = no
					OR = {
						is_in_faction = yes
						strength_ratio = { tag = ROOT ratio > 1.5 }
					}
				}
			}
		}
		if = {
			limit = { is_in_faction_with = FROM }
			remove_from_faction = ROOT
		}
		FROM = {
			add_opinion_modifier = { target = ROOT modifier = ITA_outraged }
			country_event = { id = italy_shared.133 days = 3 }
		}
	}
	option = {
		name = italy_shared.132.b #It is too risky...
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0.3
				strength_ratio = { tag = FROM ratio > 1.0 }
			}
			modifier = {
				factor = 0.3
				strength_ratio = { tag = FROM ratio > 1.5 }
			}
			modifier = {
				factor = 0.5
				FROM = { has_war = yes }
			}
		}
		add_political_power = -100
	}
}

# italy_shared makes an ultimatum: turn over Libya or else...
country_event = {
	id = italy_shared.133
	title = italy_shared.133.t
	desc = italy_shared.133.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	trigger = {
		OR = {
			owns_state = 448 #Tripoli
			any_country = {
				owns_state = 448
				is_subject_of = ROOT
			}
		}
	}
	
	immediate = {
		FROM = { save_event_target_as = aggressor }
	}

	option = {
		name = italy_shared.133.a #Right, right, we don't even need Libya that much anyway...
		ai_chance = {
			factor = 5
			modifier = {
				factor = 5
				has_war = yes
				surrender_progress > 0.10
			}
		}
		add_political_power = -300
		FROM = {
			effect_tooltip = {
				if = {
					limit = { event_target:puppet_owner = { owns_state = 448 } }
					puppet = event_target:puppet_owner
				}
				ROOT = {
					every_owned_state = {
						limit = { is_core_of = LBA }
						event_target:aggressor = { transfer_state = PREV }
					}
				}
			}
			country_event = { id = italy_shared.134 hours = 3 }
		}
	}
	option = {
		name = italy_shared.133.b #Such insolence will be punished!
		ai_chance = {
			factor = 95
			modifier = {
				factor = 0.5
				has_war = yes
			}
			modifier = {
				factor = 0.5
				strength_ratio = { tag = FROM ratio < 0.75 }
			}
		}
		FROM = { set_country_flag = ITA_libya_war }
		add_political_power = 100
		diplomatic_relation = { country = FROM relation = non_aggression_pact active = no }
		declare_war_on = {
			target = FROM
			type = annex_everything
		}
	}
}

# The ultimatum succeeds: Libya is surrendered
country_event = {
	id = italy_shared.134
	title = italy_shared.134.t
	desc = italy_shared.134.d
	picture = GFX_LBA_Camel1

	is_triggered_only = yes

	immediate = {
		random_country = {
			limit = {
				owns_state = 448 #Tripoli
				is_subject_of = FROM
			}
			save_event_target_as = puppet_owner
		}
	}

	option = {
		name = italy_shared.134.a
		add_political_power = 100
		if = {
			limit = { event_target:puppet_owner = { owns_state = 448 } }
			puppet = event_target:puppet_owner
			event_target:puppet_owner = { country_event = italy_shared.141 }
		}
		FROM = {
			every_owned_state = {
				limit = { is_core_of = LBA }
				ROOT = { transfer_state = PREV }
			}
		}
	}
}

# Libya's owner is winning - white peace?
country_event = {
	id = italy_shared.135
	title = italy_shared.135.t
	desc = italy_shared.135.d
	picture = GFX_report_event_generic_towar

	fire_only_once = yes

	trigger = {
		has_war = yes
		NOT = { surrender_progress > 0.10 }
		any_enemy_country = {
			has_war_with = ROOT
			has_country_flag = ITA_libya_war
			surrender_progress > 0.20
		}
		OR = {
			AND = {
				owns_state = 448
				controls_state = 448
			}
			any_country = {
				is_subject_of = ROOT
				owns_state = 448
				controls_state = 448
			}
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	immediate = {
		random_enemy_country = {
			limit = { has_country_flag = ITA_libya_war }
			clr_country_flag = ITA_libya_war
			save_event_target_as = aggressor
		}
	}

	option = {
		name = italy_shared.135.a #Send an envoy to demand peace and concessions
		ai_chance = {
			factor = 70
			modifier = {
				factor = 1.5
				event_target:aggressor = { NOT = { surrender_progress > 0.10 } }
			}
		}
		add_political_power = 100
		event_target:aggressor = { country_event = { id = italy_shared.136 } }
	}
	option = {
		name = italy_shared.135.b #This war won't be over until we're marching on Rome!
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.5
				event_target:aggressor = { NOT = { surrender_progress > 0.10 } }
			}
		}
		add_political_power = -100
	}
}

# Sued for peace: italy_shared gives up claims
country_event = {
	id = italy_shared.136
	title = italy_shared.136.t
	desc = italy_shared.136.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.136.a #Yes, let's end this now
		ai_chance = { factor = 100 }
		add_political_power = -300
		FROM = { white_peace_with_ROOT = yes }
		every_state = {
			limit = {
				is_claimed_by = ROOT
				is_core_of = LBA
			}
			ROOT = { remove_state_claim = PREV }
		}
		if = {
			limit = { owns_state = 115 } #Sicily
			FROM = { transfer_state = 115 }
		}
		if = {
			limit = { owns_state = 116 } #Malta
			FROM = { transfer_state = 116 }
		}
		if = {
			limit = { any_owned_state = { is_core_of = TUN } }
			every_owned_state = {
				limit = { is_core_of = TUN }
				FROM = { transfer_state = PREV }
			}
		}
		if = {
			limit = { MLT = { is_subject_of = ROOT } }
			FROM = { puppet = MLT }
		}
		if = {
			limit = { TUN = { is_subject_of = ROOT } }
			FROM = { puppet = TUN }
		}
	}
	option = {
		name = italy_shared.136.b #No, we can still win this!
		ai_chance = { factor = 0 }
		add_political_power = -100
	}
}

# italy_shared has taken Libya - white peace?
country_event = {
	id = italy_shared.137
	title = italy_shared.137.t
	desc = italy_shared.137.d
	picture = GFX_report_event_generic_towar

	fire_only_once = yes

	trigger = {
		has_war = yes
		any_enemy_country = {
			has_war_with = ROOT
			NOT = { any_owned_state = { is_controlled_by = ROOT } }
			NOT = { surrender_progress > 0.10 }
			has_country_flag = ITA_libya_war
			OR = {
				controls_state = 448
				any_allied_country = { controls_state = 448 }
			}
		}
		OR = {
			owns_state = 448
			any_country = {
				is_subject_of = ROOT
				owns_state = 448
			}
		}
		NOT = {
			any_owned_state = {
				is_core_of = LBA
				is_controlled_by = ROOT
			}
			any_country = {
				is_subject_of = ROOT
				any_owned_state = {
					is_core_of = LBA
					is_controlled_by = PREV
				}
			}
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	immediate = {
		random_enemy_country = {
			limit = { has_country_flag = ITA_libya_war }
			clr_country_flag = ITA_libya_war
			save_event_target_as = aggressor
		}
	}

	option = {
		name = italy_shared.137.a #Sign a peace treaty and cede Libya to the Italians
		ai_chance = { factor = 90 }
		add_political_power = -100
		event_target:aggressor = { country_event = { id = italy_shared.138 } }
	}
	option = {
		name = italy_shared.137.b #This war won't be over until we're marching on Rome!
		ai_chance = { factor = 10 }
		add_political_power = 100
	}
}

# Sued for peace: Libya is surrendered
country_event = {
	id = italy_shared.138
	title = italy_shared.138.t
	desc = italy_shared.138.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	option = {
		name = italy_shared.138.a #Yes, let's end this now
		ai_chance = { factor = 100 }
		add_political_power = 100
		FROM = { white_peace_with_ROOT = yes }
		if = {
			limit = { event_target:puppet_owner = { owns_state = 448 } }
			puppet = event_target:puppet_owner
			else = {
				FROM = {
					every_owned_state = {
						limit = { is_core_of = LBA }
						ROOT = { transfer_state = PREV }
					}
				}
			}
		}
	}
	option = {
		name = italy_shared.138.b #This war won't be over until we're marching on [From.Capital.GetName]!
		ai_chance = { factor = 0 }
		add_political_power = -100
	}
}

# Libya is integrated into italy_shared
country_event = {
	id = italy_shared.139
	title = italy_shared.139.t
	desc = italy_shared.139.d
	picture = GFX_LBA_Camel1

	fire_only_once = yes

	trigger = {
		OR = {
			tag = ITA
			tag = SRD
			tag = SIC
			tag = PAP
			tag = SRI
		}
		has_war = no
		any_owned_state = {
			is_core_of = LBA
			NOT = { is_core_of = ROOT }
		}
	}

	mean_time_to_happen = {
		months = 6
		modifier = {
			factor = 0.5
			any_owned_state = {
				is_core_of = LBA
				NOT = { is_core_of = ROOT }
				is_claimed_by = ROOT
			}
		}
	}

	immediate = { clr_country_flag = ITA_libya_war }

	option = {
		name = italy_shared.139.a #Integrate Libya into italy_shared proper
		ai_chance = { factor = 5 }
		add_political_power = -50
		every_owned_state = {
			limit = {
				OR = {
					is_core_of = LBA 
					is_core_of = TRP 
					state = 450
				} 
			}
			add_core_of = ROOT
		}
	}
}

# italy_shared failed to take Libya in the war
country_event = {
	id = italy_shared.140
	title = italy_shared.140.t
	desc = italy_shared.140.d
	picture = GFX_LBA_Camel1

	fire_only_once = yes

	trigger = {
		OR = {
			tag = ITA
			tag = SRD
			tag = SIC
			tag = PAP
			tag = SRI
		}
		has_country_flag = ITA_libya_war
		has_war = no
		NOT = {
			any_owned_state = { is_core_of = LBA }
			any_country = {
				is_subject_of = ROOT
				any_owned_state = { is_core_of = LBA }
			}
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	option = {
		name = italy_shared.140.a
		clr_country_flag = ITA_libya_war
		add_political_power = -100
	}
}

# Puppet has been 'sold' to the Italians - do we submit
country_event = {
	id = italy_shared.141
	title = italy_shared.141.t
	desc = italy_shared.141.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				is_in_faction = yes
				NOT = { is_in_faction_with = FROM }
			}
			remove_from_faction = ROOT
		}
	}

	option = {
		name = italy_shared.141.a #We will submit to our new masters
		ai_chance = {
			factor = 75
			modifier = {
				factor = 1.5
				strength_ratio = { tag = FROM ratio < 0.5 }
			}
			modifier = {
				factor = 1.5
				strength_ratio = { tag = FROM ratio < 0.25 }
			}
		}
		add_political_power = -100
	}
	option = {
		name = italy_shared.141.b #Never! We will fight for our independence!
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				tag = LBA
			}
			modifier = {
				factor = 0
				tag = MLT
			}
			modifier = {
				factor = 2
				strength_ratio = { tag = FROM ratio > 0.75 }
			}
			modifier = {
				factor = 2
				strength_ratio = { tag = FROM ratio > 1.00 }
			}
		}
		add_political_power = 100
		FROM = { end_puppet = ROOT }
		if = {
			limit = { is_in_faction_with = FROM }
			random_country = {
				limit = {
					is_in_faction_with = ROOT
					is_faction_leader = yes
				}
				remove_from_faction = ROOT
			}
		}
		FROM = {
			country_event = { id = italy_shared.142 days = 3  }
		}
	}
}

# New puppet resists being purchased
country_event = {
	id = italy_shared.142
	title = italy_shared.142.t
	desc = italy_shared.142.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.142.a #Let them go
		ai_chance = {
			factor = 5
			modifier = {
				factor = 5
				has_war = yes
			}
		}
		add_political_power = -100
	}
	option = {
		name = italy_shared.142.b #Oh, really?
		ai_chance = {
			factor = 95
		}
		declare_war_on = {
			target = FROM
			type = annex_everything
		}
	}
}

# italy_shared attempts to join a faction
country_event = {
	id = italy_shared.18
	title = italy_shared.18.t
	desc = italy_shared.18.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.18.a #Admit them into the faction
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				has_guaranteed = FROM
			}
			modifier = {
				factor = 1.5
				tag = AUS
			}
			modifier = {
				factor = 0.5
				tag = CAN
			}
		}
		effect_tooltip = { add_to_faction = FROM }
		FROM = { country_event = { id = italy_shared.20 } }
	}
	option = {
		name = italy_shared.18.b #We will guarantee their independence instead
		trigger = {
			NOT = {
				original_tag = RUS
				original_tag = TRM
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = ITA_forpol
						option = ITA_FORPOL_REICHSPAKT
					}
					has_game_rule = {
						rule = ITA_forpol
						option = ITA_FORPOL_AUSTRIA
					}
					has_game_rule = {
						rule = ITA_forpol
						option = ITA_FORPOL_ENTENTE
					}
				}
			}
			modifier = {
				factor = 1.5
				tag = AUS
			}
			modifier = {
				factor = 0.5
				tag = CAN
			}
		}
		effect_tooltip = {
			give_guarantee = FROM
			give_military_access = FROM
		}
		FROM = { country_event = { id = italy_shared.21 } }
	}
	option = {
		name = italy_shared.18.c #They are on their own
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				OR = {
					has_game_rule = { rule = ITA_forpol option = ITA_FORPOL_REICHSPAKT }
					has_game_rule = { rule = ITA_forpol option = ITA_FORPOL_AUSTRIA }
					has_game_rule = { rule = ITA_forpol option = ITA_FORPOL_ENTENTE }
					has_game_rule = { rule = ITA_forpol option = ITA_FORPOL_RUSSIA }
				}
			}
			modifier = {
				factor = 0.8
				has_opinion = { target = FROM value > 20 }
			}
			modifier = {
				factor = 0.5
				has_opinion = { target = FROM value > 50 }
			}
			modifier = {
				factor = 0.5
				has_opinion = { target = FROM value > 100 }
			}
			modifier = {
				factor = 1.2
				has_opinion = { target = FROM value < 0 }
			}
			modifier = {
				factor = 1.5
				has_opinion = { target = FROM value < -50 }
			}
			modifier = {
				factor = 2
				has_opinion = { target = FROM value < -100 }
			}
			modifier = {
				factor = 0.5
				tag = AUS
			}
			modifier = {
				factor = 1.5
				tag = CAN
			}
			modifier = {
				factor = 1.5
				FROM = { has_government = national_populist }
				NOT = { original_tag = RUS }
			}
		}
		FROM = { country_event = { id = italy_shared.22 } }
	}
}

# italy_shared seeks a country's protection
country_event = {
	id = italy_shared.19
	title = italy_shared.19.t
	desc = italy_shared.19.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = italy_shared.19.a #That sounds like an excellent deal
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.5
				tag = AUS
			}
			modifier = {
				factor = 0.5
				tag = CAN
			}
		}
		effect_tooltip = {
			give_guarantee = FROM
			give_military_access = FROM
		}
		FROM = { country_event = { id = italy_shared.21 } }
	}
	option = {
		name = italy_shared.19.b #They are on their own
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.8
				has_opinion = { target = FROM value > 20 }
			}
			modifier = {
				factor = 0.5
				has_opinion = { target = FROM value > 50 }
			}
			modifier = {
				factor = 0.5
				has_opinion = { target = FROM value > 100 }
			}
			modifier = {
				factor = 1.2
				has_opinion = { target = FROM value < 0 }
			}
			modifier = {
				factor = 1.5
				has_opinion = { target = FROM value < -50 }
			}
			modifier = {
				factor = 2
				has_opinion = { target = FROM value < -100 }
			}
			modifier = {
				factor = 0.5
				tag = AUS
			}
			modifier = {
				factor = 1.5
				tag = CAN
			}
			modifier = {
				factor = 1.5
				FROM = { has_government = national_populist }
			}
		}
		FROM = { country_event = { id = italy_shared.22 } }
	}
}

# italy_shared is admitted to a faction
country_event = {
	id = italy_shared.20
	title = italy_shared.20.t
	desc = italy_shared.20.d
	picture = diplomacy3

	is_triggered_only = yes

	option = {
		name = italy_shared.20.a
		add_political_power = 40
		FROM = { add_to_faction = ROOT }
	}
}

# italy_shared is given guarantee rather than admission to a faction
country_event = {
	id = italy_shared.21
	title = italy_shared.21.t
	desc = italy_shared.21.d
	picture = diplomacy3

	is_triggered_only = yes

	option = {
		name = italy_shared.21.a
		add_political_power = 20
		FROM = { give_guarantee = ROOT }
		FROM = { give_military_access = ROOT }
		hidden_effect = {
			every_country = {
				limit = { is_in_faction_with = FROM }
				give_military_access = ROOT
			}
		}
	}
	
	option = { #Let us spit on this guarantee, Tfu Tfu
		name = italy_shared.21.b
		FROM = { country_event = { id = italy_shared.24 } }
		custom_effect_tooltip = ITA_choose_different_faction
		hidden_effect = {
			country_event = { id = italy_shared.25 days = 3 }
		}
	}
}

# italy_shared is turned down
country_event = {
	id = italy_shared.22
	title = italy_shared.22.t
	desc = italy_shared.22.d
	picture = GFX_report_event_worried_french

	is_triggered_only = yes

	option = {
		name = italy_shared.22.a
		add_political_power = -20
		hidden_effect = {
			country_event = { id = italy_shared.25 days = 3 }
		}
	}
}

#Italian Rejection
country_event = {
	id = italy_shared.24
	title = italy_shared.24.t
	desc = italy_shared.24.d
	picture = diplomacy3

	is_triggered_only = yes

	option = {
		name = italy_shared.24.a
	}
}

#Find new option
country_event = {
	id = italy_shared.25
	title = italy_shared.25.t
	desc = italy_shared.25.d
	picture = diplomacy3

	is_triggered_only = yes

	option = {#Try Austria
		name = italy_shared.25.a
		trigger = {
			NOT = { has_country_flag = ITA_austria_faction_asked }
			country_exists = AUS
			AUS = {
			is_faction_leader = yes
			is_subject = no
			}
			OR = {
				has_country_leader = { name = "Julius IV" }
				NOT = { has_government = national_populist }
			}
			NOT = { any_owned_state = { is_core_of = AUS } }
			has_socialist_government = no
		}
		ai_chance = {
			factor = 2
			modifier = {
				factor = 0
				AUS = {
					has_war = yes
					surrender_progress > 0.25
				}
			}
			modifier = {
				factor = 0
				AUS = {
					strength_ratio = {
						tag = ITA
						ratio < 1.0
					}
				}
			}
			modifier = {
				factor = 0
				OR = {
					AUS = { any_owned_state = { is_core_of = ITA } }
					any_country = {
						is_in_faction_with = AUS
						any_owned_state = { is_core_of = ITA }
					}
				}
			}
		}
		set_country_flag = ITA_austria_faction_asked
		add_opinion_modifier = {
			target = AUS
			modifier = KR_approves_of_govt
		}
		reverse_add_opinion_modifier = {
			target = AUS
			modifier = KR_approves_of_govt
		}
		if = {
			limit = { AUS = { is_faction_leader = yes } }
			AUS = { country_event = italy_shared.18 }
		}
		else = { AUS = { country_event = italy_shared.19 } }
	}
	
	option = { #Try Germany
		name = italy_shared.25.b
		trigger = {
			NOT = { has_country_flag = ITA_germany_faction_asked }
			country_exists = GER
			GER = {
				is_faction_leader = yes
				NOT = { any_owned_state = { is_core_of = ITA } }
			}
			has_socialist_government = no
		}
		ai_chance = {
			factor = 3
			modifier = {
				factor = 0.1
				GER = {
					has_war = yes
					surrender_progress > 0.25
				}
			}
			modifier = {
				factor = 0.1
				strength_ratio = {
					tag = GER
					ratio > 1.0
				}
			}
			modifier = {
				factor = 0
				OR = {
					GER = { any_owned_state = { is_core_of = ITA } }
					any_country = {
						is_in_faction_with = GER
						any_owned_state = { is_core_of = ITA }
					}
				}
			}
		}
		hidden_effect = {
			set_country_flag = ITA_germany_faction_asked
			add_opinion_modifier = {
				target = GER
				modifier = KR_approves_of_govt
			}
			reverse_add_opinion_modifier = {
				target = GER
				modifier = KR_approves_of_govt
			}
			GER = { country_event = italy_shared.18 }
		}
	}
	
	option = { #Try Entente
		name = italy_shared.25.c
		trigger = {
			NOT = { has_country_flag = ITA_canada_faction_asked }
			country_exists = ENT
			ENT = { is_faction_leader = yes }
			has_socialist_government = no
		}
		ai_chance = {
			factor = 2
			modifier = {
				factor = 0.1
				ENT = {
					has_war = yes
					surrender_progress > 0.25
				}
			}
			modifier = {
				factor = 0.1
				OR = {
					ENT = { any_owned_state = { is_core_of = ITA } }
					any_country = {
						is_in_faction_with = ENT
						any_owned_state = { is_core_of = ITA }
					}
				}
			}
		}
		hidden_effect = {
			set_country_flag = ITA_canada_faction_asked
			add_opinion_modifier = {
				target = ENT
				modifier = KR_approves_of_govt
			}
			reverse_add_opinion_modifier = {
				target = ENT
				modifier = KR_approves_of_govt
			}
			ENT = { country_event = italy_shared.18 }
		}
	}
	
	option = { #Try Russia
		name = italy_shared.25.f
		trigger = {
			NOT = { 
				has_country_flag = ITA_russia_faction_asked
				tag = SRI
			}
			has_completed_focus = ITA_Irredentism
			OR = {
				AND = {
					RUS = {
						NOT = { has_country_flag = soviet_russia_restored }
						is_faction_leader = yes
						exists = yes
					}
					OR = {
						AND = {
							has_socialist_government = yes
							RUS = { has_socialist_government = yes }
						}
						AND = {
							has_socialist_government = no
							RUS = { has_socialist_government = no }
						}
					}
				}
				TRM = {
					NOT = { 
						has_country_flag = soviet_russia_restored
						has_socialist_government = yes
					}
					is_faction_leader = yes
					exists = yes
					has_country_flag = TRM_become_russia
				}
			}
		}
		ai_chance = {
			factor = 2
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = ITA_forpol
						option = ITA_FORPOL_ENTENTE
					}
					has_game_rule = {
						rule = ITA_forpol
						option = ITA_FORPOL_REICHSPAKT
					}
					has_game_rule = {
						rule = ITA_forpol
						option = ITA_FORPOL_AUSTRIA
					}
				}
			}
			modifier = {
				factor = 0.25
				NOT = {
					has_government = paternal_autocrat
					has_government = national_populist
					AND = {
						has_government = radical_socialist
						RUS = {
							OR = {
								has_government = social_democrat
								has_government = radical_socialist
							}
						}
					}
				}
			}
		}
		hidden_effect = {
			set_country_flag = ITA_russia_faction_asked
			if = {
				limit = {
					TRM = { 
						is_faction_leader = yes
						has_country_flag = TRM_become_russia
						owns_state = 3290
					}
					RUS = {
						OR = {
							exists = no
							is_subject = yes
						}
					}
				}
				TRM = { country_event = italy_shared.18 }
				add_opinion_modifier = {
					target = TRM
					modifier = KR_approves_of_govt
				}
				reverse_add_opinion_modifier = {
					target = TRM
					modifier = KR_approves_of_govt
				}
			}
			else = {
				RUS = { country_event = italy_shared.18 }
				add_opinion_modifier = {
					target = RUS
					modifier = KR_approves_of_govt
				}
				reverse_add_opinion_modifier = {
					target = RUS
					modifier = KR_approves_of_govt
				}
			}
		}
	}
	
	option = { #insert blackjack and hookers joke
		name = italy_shared.25.e
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				has_government = national_populist
			}
			modifier = {
				factor = 2
				is_actual_major = yes
			}
		}
		country_event = itaforpol.1
		add_political_power = 30
		add_stability = 0.05
	}
}

# Irridentism and junk
country_event = {
	id = italy_shared.30
	title = italy_shared.30.t
	desc = italy_shared.30.d
	picture = GFX_report_event_generic_towar

	is_triggered_only = yes

	trigger = {
		is_subject = no
	}

	option = {
		name = italy_shared.30.a #We are ready to reclaim our rightful land
		ai_chance = {
			factor = 30
			modifier = {
				factor = 1.5
				has_war = yes
			}
		}
		set_country_flag = ITA_irridentism_flag
		set_country_flag = ITA_forpol_unlocked
		mark_focus_tree_layout_dirty = yes
		add_war_support = 0.05
	}
	option = {
		name = italy_shared.30.b #Nah
		ai_chance = {
			factor = 70
			modifier = {
				factor = 2
				is_in_faction = yes
			}
		}
		add_stability = 0.05
		set_country_flag = ITA_neutral
		set_country_flag = ITA_forpol_unlocked
		mark_focus_tree_layout_dirty = yes
	}
}

# Hidden event to remove potential ICW buffs
country_event = {
	id = italy_shared.1000
	immediate = {log = "[GetDateText]: [Root.GetName]: event italy_shared.1000"}
	
	is_triggered_only = yes
	hidden = yes

	trigger = {
		OR = {
			AND = {
				country_exists = ITA
				SRI = { exists = no }
				SRD = {
					OR = { 
						exists = no
						has_country_flag = SRD_piedmont_flag
					}
				}
				SIC = { exists = no }
				PAP = { exists = no }
				VNC = { exists = no }
				LOM = { exists = no }
			}
			AND = {
				country_exists = SRI
				ITA = { exists = no }
				SRD = { 
					OR = { 
						exists = no
						has_country_flag = SRD_piedmont_flag
					}
				}
				SIC = { exists = no }
				PAP = { exists = no }
				VNC = { exists = no }
				LOM = { exists = no }
			}
			AND = {
				country_exists = SRD
				ITA = { exists = no }
				SRI = { exists = no }
				SIC = { exists = no }
				PAP = { exists = no }
				VNC = { exists = no }
				LOM = { exists = no }
			}
			AND = {
				country_exists = SIC
				SRI = { exists = no }
				ITA = { 
					OR = {	
						exists = no
						is_subject_of = SIC
					}
				}
				SRD = {
					OR = { 
						exists = no
						has_country_flag = SRD_piedmont_flag
						is_subject_of = SIC
					}
				}
				PAP = { 
					OR = {	
						exists = no
						is_guaranteed_by = SIC
						is_subject_of = SIC
					}
				}
				VNC = { 
					OR = {	
						exists = no
						is_subject_of = SIC
					}
				}
				LOM = { 
					OR = {	
						exists = no
						is_subject_of = SIC
					}
				}
			}
			AND = {
				country_exists = PAP
				SRI = { exists = no }
				ITA = { exists = no }
				SRD = {
					OR = { 
						exists = no
						has_country_flag = SRD_piedmont_flag
					}
				}
				SIC = { exists = no }
				VNC = { exists = no }
				LOM = { exists = no }
			}
			AND = {
				country_exists = VNC
				SRI = { exists = no }
				ITA = { exists = no }
				SRD = {
					OR = { 
						exists = no
						has_country_flag = SRD_piedmont_flag
					}
				}
				SIC = { exists = no }
				PAP = { exists = no }
				LOM = { exists = no }
			}
			AND = {
				country_exists = LOM
				SRI = { exists = no }
				ITA = { exists = no }
				SRD = {
					OR = { 
						exists = no
						has_country_flag = SRD_piedmont_flag
					}
				}
				SIC = { exists = no }
				PAP = { exists = no }
				VNC = { exists = no }
			}
		}
	}

	option = {
		set_global_flag = ICW_over
	}
}